Subreddit: excel
Title: Combine workbooks matching data and adding column
Author: tartanthing
Score: 2
Created UTC: 2021-08-18 17:47:06
URL: https://www.reddit.com/r/excel/comments/p6w9h9/combine_workbooks_matching_data_and_adding_column/

Giving this a bump, thanks for answers so far, I couldn't get it work using the linked blog.  
I've done a version on google sheets, as I cant see a way to upload an excel format version.

[Merge sheets and data](https://docs.google.com/spreadsheets/d/1Q7UlE5RnKEzGY4WlnpzQ0pwyV06U7GVZBpxQk-G6v-Y/edit?usp=sharing)

As before start with master, want to combine all subsequent sheets to end with Merged Results. Some conditions: Only the names on the Master sheet should appear on the Merged Results. 

The lists of names in the years are often in random order. Ideal conditions should be matching id, first and last names will generate an entry of Y, N or blank matching the year.  
Hope this clarifies !

Cheers all!

<earlier post> I have a series of workbooks I want to merge into a master list and I'm struggling to find anything that quite fits online in videos.

My Master workbook has a series of names with additional data in columns. I want to merge it, matching the names. If a name matches I want to add the data from a single column in a separate workbook into a new column in the master workbook sheet. The data to be imported is in different years in different workbooks, so I want a new column for each year.

Can anyone help please? If you can ELI5 for me that would be useful. I can do basic stuff with excel.

Here's an example of the data/result wanted. Apologies for formatting, Reddit is awkward or I am a simpleton.

Master table

First         LastRoger      RabbitDonald    Duck

Workbook 1 2021

First        Last       Yes/NoRoger     Rabbit   YesDonald   Duck     No

Workbook 2 Year 2020

First       Last           Yes/NoRoger    Rabbit       NoDonald  Duck         YesDick       Dastardly  No

Workbook 3 Year 2019

First       Last         Yes/NoRoger    Rabbit    YesDonald  Duck      YesPrinces  Jasmine Yes

So the Yes/No doesn't exist in the master workbook, I want to add new column for Yes/No with header being the year for each year to get the following:

First      Last       2019    2020      2021Roger  Rabbit    Yes      No          YesDonald Duck     Yes      Yes          No

The master copy would exclude every name it doesn't have (ie master doesn't have Princess Jasmine or Dick Dastardly as their names do not appear on the master workbook)

The Master workbook has 87 columns currently which cannot be changed.

So the new table would exclude Princes Jasmine and Dick Dastardly but Include Roger Rabbit and Donald Duck.

Does that clarify? I can't post the actual's due to GDPR restrictions.

||||
|:-|:-|:-|
||||

Cheers